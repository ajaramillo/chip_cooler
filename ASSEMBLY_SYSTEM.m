% matrix assembly
M = sparse( [II II II II II,...
            IN IN IN IN,...
            IW IW IW IW,...
            IE IE IE IE,...
            ISF ISF ISF ISF,...
            IS0 IS0 IS0 IS0,...
            ISW ISW ISW,...
            ISE ISE ISE,...
            INW INW INW,...
            INE INE INE],...
            ...
            [II II+1 II-1 II+Nr II-Nr,...
            IN IN+1 IN-1 IN-Nr,...
            IW IW+1 IW+Nr IW-Nr,...
            IE IE-1 IE+Nr IE-Nr,...
            ISF ISF+1 ISF-1 ISF+Nr,...
            IS0 IS0+1 IS0-1 IS0+Nr,...
            ISW ISW+1 ISW+Nr,...
            ISE ISE-1 ISE+Nr,...
            INW INW+1 INW-Nr,...
            INE INE-1 INE-Nr],...
            ...
            [-2/dr^2-2/dz^2+II*0, 1/dr^2+II*0, 1/dr^2+II*0, 1/dz^2+II*0, 1/dz^2+II*0,... %II
            -2/dr^2-2/dz^2+1/dz^2/(1-k2*dz)+IN*0, 1/dr^2+IN*0, 1/dr^2+IN*0, 1/dz^2+IN*0,...IN
            -1/dr^2-2/dz^2+IW*0, 1/dr^2+IW*0, 1/dz^2+IW*0, 1/dz^2+IW*0,... %IW
            -1/dr^2-2/dz^2+IE*0, 1/dr^2+IE*0, 1/dz^2+IE*0, 1/dz^2+IE*0,... %IE
            -2/dr^2-1/dz^2+ISF*0, 1/dr^2+ISF*0, 1/dr^2+ISF*0, 1/dz^2+ISF,... %ISF
            -2/dr^2-1/dz^2+IS0*0, 1/dr^2+IS0*0, 1/dr^2+IS0*0, 1/dz^2+IS0*0,... %IS0
            -1/dr^2-1/dz^2+ISW*0, 1/dr^2+ISW*0, 1/dz^2+ISW*0,... %ISW
            -1/dr^2-1/dz^2+ISE*0, 1/dr^2+ISE*0, 1/dz^2+ISE*0,... %ISE
            -1/dr^2-1/dz^2+INW*0, 1/dr^2+INW*0, 1/dz^2+INW*0,... %INW
            -1/dr^2-1/dz^2+INE*0, 1/dr^2+INE*0, 1/dz^2+INE*0],... %INE
            Nr*Nz, Nr*Nz);
        
% right hand side
b = zeros(Nr*Nz, 1);
b([IN INE INW]) = k2/(1-k2*dz)/dz;
b([ISF ISW]) = -k1/dz;